jQuery(document).ready(function(e){function t(t){var a=!0;return t.find(":input[required], select[required]").each(function(t){switch(e(this).prop("tagName").toLocaleLowerCase()){case"input":a=!!function(t){var a=!0,c=e(t).attr("type");switch(a=!!i(t)&&a,c){case"email":if(a){var r=RegExp(/^([a-z\d!#$%&'*+\-\/=?^_`{|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+(\.[a-z\d!#$%&'*+\-\/=?^_`{|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+)*|"((([ \t]*\r\n)?[ \t]+)?([\x01-\x08\x0b\x0c\x0e-\x1f\x7f\x21\x23-\x5b\x5d-\x7e\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|\\[\x01-\x09\x0b\x0c\x0d-\x7f\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))*(([ \t]*\r\n)?[ \t]+)?")@(([a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|[a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF][a-z\d\-._~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]*[a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])\.)+([a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|[a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF][a-z\d\-._~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]*[a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])\.?$/i);a=!!r.test(e(t).val())&&a,u(e(t),a?"good":"wrong_mail")}else u(e(t),"empty");break;case"number":a?(a=!!e.isNumeric(e(t).val())&&a,u(e(t),a?"good":"wrong_number")):u(e(t),"empty");break;case"date":if(a){var s=Date.parse(e(t).val());if(!(a=!!s&&a)){var _=e(t).val().split("/"),o=_[2]+"-"+_[1]+"-"+_[0];s=Date.parse(o),a=!!s||a}u(e(t),a?"good":"wrong_date")}else u(e(t),"empty");break;case"radio":if(a){var n=e(t).closest(".form-field"),l=n.find(".yes-no_option_yes"),d=n.find(".yes-no_option_no");!l.is(":checked")&!d.is(":checked")?(a=!1,u(t,"empty")):u(t,"good")}break;default:u(t,a?"good":"empty")}return a}(this)&&a;break;case"select":a=!!function(t){var a=!0;e(t).is(":disabled")?(e(t).val(""),a=!1):a=!!i(t)&&a;u(e(t),a?"good":"empty");return a}(this)&&a}}),a}function i(t){var i=!0;return null!=e(t).val()?i=0!==e(t).val().length&&i:(e(t).val(""),i=!1),i}function a(){var t=e(this).val()-e(".field_service_row").length;if(t>=0){if(yith_wcevti_tickets.sold_individually){var i=e(".field_service_row").length;if(e(".cart").block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),yith_wcevti_tickets.ajax_enable){var a={action:"load_fields_event_action",num_rows:t,current_index:i,product_id:yith_wcevti_tickets.product.id,event_title:e(".yith_evti_event_title").val()};e.post(event_tickets_frontend.ajaxurl,a).success(function(t){e(".fields_panel").append(t),e(".cart").unblock(),l(),e(".field_service_row .remove").show(),e(".field_service_row .remove").first().hide()})}else{for(var r=0;r<t;r++){i=e(".field_service_row").length;var s=e(".field_service_row").first().clone();s=c(s,i,!0),e(".fields_panel").append(s),s.find(".content_service_row").toggle(!0)}e(".cart").unblock(),l(),e(".field_service_row .remove").show(),e(".field_service_row .remove").first().hide()}e(".cart").find("._field_datepicker").removeClass("hasDatepicker"),e(".cart").find("._field_datepicker").datepicker({dateFormat:yith_wcevti_tickets.format_date,changeMonth:!0,changeYear:!0,yearRange:"-100:+0"})}_()}else 0!=t&&(confirm(yith_wcevti_tickets.messages.ask_for_delete_ticket+" "+-1*t+" "+yith_wcevti_tickets.messages.tickets),void 0!==Cookies.get("quantity")&&l(),function(t){t*=-1;var i=e(".field_service_row").length-t;e(".field_service_row").each(function(t,a){t>0&t>=i&&(n(e(a)),a.remove())}),_()}(t))}function c(t,i,a){t.find("input, select, textarea").each(function(t){var c=e(this).attr("name");if(void 0!==c){c=c.replace(/customer\[\d+]/,"customer["+i+"]"),e(this).attr("name",c);var r=e(this).attr("id");if(void 0!==r){var s=/customer_\d+/;r=r.replace(s,"customer_"+i),s=/customer\[\d+]/,r=r.replace(s,"customer["+i+"]"),e(this).attr("id",r)}if("hidden"!==e(this).attr("type")&a&&e(this).val(""),"_services_customer_reduced-price_0"==e(this).attr("id"))e(this).closest(".service_item").find('input[type="hidden"]').each(function(t){e(this).attr("name",e(this).attr("name").replace("0",i))}),e(this).attr("id","_services_customer_reduced-price_"+i),e(this).attr("name","_reduced_price["+i+"][_value]"),e(this).attr("checked",!1),e(this).attr("value","on"),_()}}),t.find("label").each(function(t){var a=e(this).attr("for"),c=/customer_\d+/;a=a.replace(c,"customer_"+i),c=/customer\[\d+]/,a=a.replace(c,"customer["+i+"]"),e(this).attr("for",a)});var c,r=t.find(".header_service_row>h3").text();return-1!=r.search("#1")&&(r=r.search("#1")?r.slice(0,r.indexOf("#")+1):r,t.find(".header_service_row>h3").text(r+(i+1))),(c=t).find(".yith_wcevti_item_message").text(""),c.find(".yith_wcevti_item_message").removeClass("fa fa-check fa-close yith_wcevti_item_message_incomplete yith_wcevti_item_message_complete"),c.removeClass("yith_wcevti_item_panel_complete"),c.addClass("yith_wcevti_item_panel_unstyle"),t}function r(){var t=e(this).find(":selected"),i=e(this).closest(".service_panel"),a=i.find("._services_customer_"+t.attr("name")+"_field"),c=parseFloat(e("option:selected",this).data("overcharge"));i.find(".service_range>.select_range").prop("required",!1),i.find(".service_range").hide(),e(a).find(".yith_wcevti_item_message").remove(),e(a).find(".select_range").prop("required",!0),a.show(),a.hasClass("service_range")&&a.find(".select_range").trigger("change"),s(i,c)}function s(t,i){var a=parseFloat(e(t).attr("data-price_service"));a=isNaN(a)?0:a;var c=parseFloat(i),r=parseFloat(e(".yith_evti_total_price").attr("data-current_price"));r-=a,r+=c,e(".yith_evti_total_price").attr("data-current_price",r),e(t).attr("data-price_service",c),$last_price_content=e(".yith_evti_total_price>.price>.woocommerce-Price-amount").contents().last();var s=o(r);$last_price_content.hasClass("woocommerce-Price-currencySymbol")?e(".yith_evti_total_price>.price>.woocommerce-Price-amount").contents().first().replaceWith(s):e(".yith_evti_total_price>.price>.woocommerce-Price-amount").contents().last().replaceWith(s),e(document).trigger("yith_wcevti_price_refreshed",[r,s])}function _(){var t=yith_wcevti_tickets.product.price*parseFloat(e(".quantity>input[type=number]").val());e(".yith_evti_total_price").attr("data-current_price",t),e(".service_panel").attr("data-price_service",0),e("._select_item").trigger("change"),e(".checkbox").trigger("change");var i=e(".yith_evti_total_price>.price>.woocommerce-Price-amount").contents().last(),a=o(t);i.hasClass("woocommerce-Price-currencySymbol")?e(".yith_evti_total_price>.price>.woocommerce-Price-amount").contents().first().replaceWith(a):e(".yith_evti_total_price>.price>.woocommerce-Price-amount").contents().last().replaceWith(a),e(document).trigger("yith_wcevti_price_refreshed",[t,a])}function o(e){var t=yith_wcevti_tickets.product.price_decimal_sep,i=yith_wcevti_tickets.product.price_thousand_sep,a=yith_wcevti_tickets.product.price_num_decimals;return e=accounting.formatNumber(e,a,i,t)}function n(t){t.find("input, select, textarea").each(function(t){var i;i=this,Cookies.remove(e(i).attr("name"),{path:""})})}function l(){"on"!=yith_wcevti_tickets.disable_cookie&&(e(".field_service_row").each(function(t){e(this).find("input, select, textarea").each(function(t){if(void 0!==(a=Cookies.get(e(this).attr("name"))))switch(e(this).attr("type")){case"checkbox":var a="true"===a;e(this).prop("checked",a);break;case"radio":var c=a===e(this).val();e(this).prop("checked",c);break;default:e(this).val(a)}i(this)&"hidden"!==e(this).attr("type")&&e(this).closest(".form-field").show()})}),void 0!==Cookies.get("quantity")&&Cookies.set("quantity",e(".quantity>input[type=number]").val(),{path:""}))}function d(t,i){var a=e(t).closest(".field_service_row").find(".service_message");switch(a.empty(),i){case"complete":var c=e("<span/>").addClass("fa fa-check yith_wcevti_item_message yith_wcevti_item_message_complete").text(" "+yith_wcevti_tickets.messages.complete_field_service);e(t).closest(".field_service_row").removeClass("yith_wcevti_item_panel_unstyle yith_wcevti_item_panel_incomplete"),e(t).closest(".field_service_row").addClass("yith_wcevti_item_panel_complete"),c.appendTo(a);break;case"incomplete":c=e("<span/>").addClass("fa fa-close yith_wcevti_item_message yith_wcevti_item_message_incomplete").text(" "+yith_wcevti_tickets.messages.incomplete_field_service);e(t).closest(".field_service_row").removeClass("yith_wcevti_item_panel_unstyle yith_wcevti_item_panel_complete"),e(t).closest(".field_service_row").addClass("yith_wcevti_item_panel_incomplete"),c.appendTo(a)}}function u(t,i){if(e(t).prev(".yith_wcevti_item_message").remove(),$row=e(t).closest(".field_service_row").find(".service_message"),!e(t).hasClass("yes-no_option_no")){if(e(t).hasClass("yes-no_option_yes"))e(t).closest(".form-field").find(".yes-no_option_no");switch(i){case"good":e("<span/>").addClass("fa fa-check yith_wcevti_item_message yith_wcevti_item_message_good").text(" "+yith_wcevti_tickets.messages.complete_required_item).insertBefore(t),d($row,"complete");break;case"empty":e("<span/>").addClass("fa fa-close yith_wcevti_item_message yith_wcevti_item_message_empty").text(" "+yith_wcevti_tickets.messages.incomplete_required_item).insertBefore(t),d($row,"incomplete");break;case"wrong_mail":e("<span/>").addClass("fa fa-close yith_wcevti_item_message yith_wcevti_item_message_empty").text(" "+yith_wcevti_tickets.messages.wrong_mail_field).insertBefore(t),d($row,"incomplete");break;case"wrong_number":e("<span/>").addClass("fa fa-close yith_wcevti_item_message yith_wcevti_item_message_empty").text(" "+yith_wcevti_tickets.messages.wrong_number_field).insertBefore(t),d($row,"incomplete");break;case"wrong_date":e("<span/>").addClass("fa fa-close yith_wcevti_item_message yith_wcevti_item_message_empty").text(" "+yith_wcevti_tickets.messages.wrong_date_field).insertBefore(t),d($row,"incomplete");break;default:e(t).prev(".yith_wcevti_item_message").remove()}}}!function(){if(e(".fields_panel").on("click",".header_service_row",function(){e(this).next().toggle("fast")}),e(".fields_panel").on("click",".header_service_row .remove",function(t){if(t.preventDefault(),confirm(yith_wcevti_tickets.messages.ask_for_delete_ticket+" "+yith_wcevti_tickets.messages.ticket+"?")){var i=e(this).closest(".field_service_row");i.remove(),n(i),e(".quantity>input[type=number]").val(e(".field_service_row").length),void 0!==Cookies.get("quantity")&&Cookies.set("quantity",e(".quantity>input[type=number]").val(),{path:""}),_(),e(".field_service_row").each(function(t){0!=t&&c(e(this),t,!1)})}}),e(".fields_panel").on("change","input, select",function(){var i=e(this).closest(".field_service_row");0!=e(this).prev(".yith_wcevti_item_message_empty, .yith_wcevti_item_message_good").length&&(t(i)||d(i,"incomplete"))}),e(".single_add_to_cart_button").on("click",function(){e(".field_service_row").each(function(i){if(!t(e(this)))return e(this).find(".content_service_row").toggle(!0),d(this,"incomplete"),!1}),"on"!=yith_wcevti_tickets.disable_cookie&&!1!==e(document.body).triggerHandler("yith_wcevti_save_form")&&(e(".field_service_row").each(function(t){var i=e(this);i.find("input, select, textarea").each(function(t){!function(t){if("hidden"!==e(t).attr("type")){var i=e(t).attr("name");switch(e(t).attr("type")){case"checkbox":var a=e(t).prop("checked");break;case"radio":if(!e(t).is(":checked"))return;var a=e(t).val();break;default:var a=e(t).val()}Cookies.set(i,a,{path:""})}}(this)})}),Cookies.set("quantity",e(".quantity>input[type=number]").val(),{path:""}))}),e(".entry-summary").addClass("product-addtocart"),"on"!=yith_wcevti_tickets.disable_cookie){var i=void 0!==Cookies.get("quantity")?Cookies.get("quantity"):1;e(".quantity>input[type=number]").val(i)}e(".cart").on("focus","._field_datepicker",function(){e(this).datepicker({dateFormat:"mm/dd/yy",changeMonth:!0,changeYear:!0})}),e(".cart").on("change",".quantity>input[type=number]",a),e(".quantity>input[type=number]").trigger("change")}(),e(".fields_panel").on("change","._select_item",r),e("._select_item").trigger("change"),e("._select_item").prev(".yith_wcevti_item_message").remove(),e(".fields_panel").on("change",".checkbox",function(t){var i=e(this).closest(".service_panel");e(this).is(":checked")?$overchage=parseFloat(e(this).attr("data-overcharge")):$overchage=parseFloat(0),s(i,$overchage)}),e(".checkbox").trigger("change")});