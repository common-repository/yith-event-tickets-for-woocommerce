jQuery(document).ready(function(e){function t(){e(".pricing").addClass("show_if_ticket-event"),e("#_tax_status").parents(".options_group").addClass("show_if_ticket-event"),e("select#product-type").change(),e(document.body).bind("woocommerce-product-type-change",function(){i()}),e("#general_product_data").on("click",".yith_wcevti_toggle_button",function(t){t.preventDefault();var i=e(this).data("panel");e(this).hasClass("expand")?e("#"+i).toggle(!0):e(this).hasClass("close")&&e("#"+i).toggle(!1)}),c(),n(),a(),s(),o(),l(),yith_wcevti_admin_tickets.remove.taxes_option&&e("._tax_status_field ").closest(".options_group").remove()}function i(){"ticket-event"==e("select#product-type").val()&&e("#general_product_data>.pricing").show()}function c(){e(".yith-wcevti-datepicker").each(function(){e(this).datepicker({dateFormat:yith_wcevti_admin_tickets.date_format,changeMonth:!0,changeYear:!0})})}function n(){e(".yith-wceti-timepicker").keyup(function(t){var i=e(this).val().replace(":","");isNaN(i)?(i=e(this).val().slice(0,-1),e(this).val(i)):(2==e(this).val().length&8!=t.keyCode&&e(this).val(e(this).val()+":"),5<e(this).val().length&&(i=e(this).val().slice(0,-1),e(this).val(i)))})}function a(){var t=e("#_enable_reduce_ticket"),i=e("#_reduce_ticket_event_type"),c=e("#_price_reduced_fixed"),n=e("#_price_relative_fixed"),a=e(".yith-woocommerce-event-tickets-panel");t.on("change",function(){e(this).is(":checked")?a.show():a.hide()}).change(),i.on("change",function(){"fixed"==e(this).val()?(c.parent("p").show(),n.parent("p").hide()):(c.parent("p").hide(),n.parent("p").show())}).change()}function s(){e(".yith_wcevti_increase_by_section").on("click",".remove_increase_item",function(t){t.preventDefault(),e(this).closest("tr").remove()}),e(".yith_wcevti_increase_by_section").on("click",".yith_wcevti_increase_title",function(t){t.preventDefault();var i=e(this),c=i.parent();i.next().slideToggle(300,function(){c.toggleClass("opened").toggleClass("closed")})}),e(".yith_wcevti_increase_by_section").on("change",".yith-wceti-increase-type",function(t){var i=e(this).closest("tr");switch(e(this).val()){case"fixed":i.find(".yith-wceti-increase-fixed").show(),i.find(".yith-wceti-increase-percentage").hide();break;case"percentage":i.find(".yith-wceti-increase-fixed").hide(),i.find(".yith-wceti-increase-percentage").show()}}),e(".yith_wcevti_increase_by_section").find("tbody").sortable(),e(".yith-wceti-increase-type").trigger("change")}function o(){_(),e("#_add_increase_stock_row").click({rule:"stock"},d)}function _(){e("._manage_stock_field").addClass("show_if_ticket-event"),e("select#product-type").change(),e(".enable_stock_link").click(v),e("#_manage_stock").change(r),e("#_manage_stock").trigger("change")}function r(){e("#_manage_stock").is(":checked")?(e(".enable-stock").hide(),e(".increase_stock_panel, #_add_increase_stock_row").show()):(e(".enable_stock_link").show(),e(".increase_stock_panel, #_add_increase_stock_row").hide())}function l(){e("#_add_increase_time_row").click({rule:"time"},d)}function d(t){t.preventDefault();var i=t.data.rule;e(".yith_wcevti_increase_"+i+"_section").block({message:null,overlayCSS:{background:"#fff",opacity:.6}});var c={action:"print_increase_"+i+"_row_action",index:e(".yith_evti_"+i+"_row").length};e.post(ajaxurl,c).success(function(t){e(".increase_"+i+"_panel").find("table").find("tbody").append(t),e(".yith_wcevti_increase_"+i+"_section").unblock(),e(".yith-wceti-increase-type").trigger("change")})}function v(t){t.preventDefault(),e(".general_tab").removeClass("active"),e(".inventory_tab").addClass("active"),e("#general_product_data").hide(),e("#inventory_product_data").show()}function h(){e("#_add_fields_row").click(p),e("#fields_product_data").on("click",".yith-wceti-remove-field-row button",function(t){t.preventDefault(),e(this).closest("tr").remove()}),e("#fields_product_data").on("change",".yith-wceti-field-type",function(t){var i=e(this).closest(".yith_wcevti_field_row"),c=i.find(".option-label>.woocommerce-help-tip"),n=i.find(".option-placeholder>input");"number"==e(this).val()&&n.is(":checked")?c.show():c.hide()}),e("#fields_product_data").on("click",".option-placeholder>input",function(t){var i=e(this).closest(".yith_wcevti_field_row"),c=i.find(".yith-wceti-field-type"),n=i.find(".option-label>.woocommerce-help-tip");"number"==c.val()&&e(this).is(":checked")?n.show():n.hide()}),e(".yith-wceti-field-type").trigger("change"),e(".field-options").find("tbody").sortable()}function p(t){t.preventDefault(),e("#fields_product_data").block({message:null,overlayCSS:{background:"#fff",opacity:.6}});var i={action:"print_field_row_action",index:e(".yith_wcevti_field_row").length};e.post(ajaxurl,i).success(function(t){e(".fields_panel").find("table.field-options tbody").append(t),e("#fields_product_data").unblock()})}function f(){e("#_show_service_type_selector").click(u),e("#_cancel_add_service").click(y),e("#_add_service_row").click(g),e("#services_product_data").on("click",".add_select_button",function(e){w(e)}),e("#services_product_data").on("click",".yith_wcevti_toggle_button",function(t){t.preventDefault();var i=e(this).data("panel");e(this).hasClass("expand")?e("#"+i).toggle(!0):e(this).hasClass("close")&&e("#"+i).toggle(!1)}),e("#services_product_data").on("click","._service_row_buttons>button",function(t){t.preventDefault();var i=e(this).closest(".yith_wcevti_service_row");e(this).hasClass("add_select_button")&&(i.find(".add_checkbox_button").prop("disabled",!0),i.find(".yith_wcevti-service-type").val("select"),i.find(".yith_wcevti_service_check_panel").hide(),i.find(".yith_wcevti_service_select_panel").show()),e(this).hasClass("add_checkbox_button")&&(i.find(".add_select_button").prop("disabled",!0),i.find(".yith_wcevti_service_check_panel").show(),i.find(".yith_wcevti-service-type").val("checkbox"))}),e("#services_product_data").on("click",".remove_service_row",function(t){t.preventDefault(),confirm(yith_wcevti_admin_tickets.message.remove_service)&&e(this).closest(".yith_wcevti_service_row").remove()}),e("#services_product_data").on("click",".remove_service_item",function(t){t.preventDefault(),e(this).closest("tr").remove()}),e("#services_product_data").on("click",".yith-evti-service-handle",function(){var t=e(this).closest(".yith_wcevti_service_row");t.find(".yith-evti-service-panel").slideToggle(300,function(){t.toggleClass("opened").toggleClass("closed")})}),e("#services_product_data").on("keyup",".yith-wceti-service-label",function(){var t=e(this),i=t.closest(".yith_wcevti_service_row").find(".yith-evti-service-handle").find("h3"),c=t.val();i.text(c.length?c:"-")}),e("#services_product_data").on("change",".service-type-container select",function(){var t=e(this),i=t.val(),c=t.closest(".yith-evti-service-panel"),n=c.closest(".yith_wcevti_service_row "),a=c.find(".service-checkbox-heading"),s=c.find(".service-select-heading"),o=c.find(".yith_wcevti_service_select_panel");service_type_label=n.find(".service-type"),"checkbox"==i?(a.css("display","inline-block"),s.hide(),o.hide(),service_type_label.find(".service-type-select").hide().end().find(".service-type-checkbox").show()):"select"==i&&(a.hide(),s.css("display","inline-block"),o.show(),service_type_label.find(".service-type-select").show().end().find(".service-type-checkbox").hide())}),e("#services_product_data").find(".services_panel").sortable(),e(".service-options-select").find("tbody").sortable(),e(".service-type-container select").change()}function u(t){var i=e("#_show_service_type_selector"),c=e("#_service_type_selector_container");void 0!==t&&t.preventDefault(),i.hide(),c.slideDown()}function y(t){var i=e("#_show_service_type_selector"),c=e("#_service_type_selector_container");void 0!==t&&t.preventDefault(),i.show(),c.slideUp()}function g(t){t.preventDefault(),e("#services_product_data").block({message:null,overlayCSS:{background:"#fff",opacity:.6}});var i={action:"print_service_row_action",index:j++,type:e("#_service_type_selector").val()};e.post(ajaxurl,i).success(function(t){e(".yith-evti-service-panel").slideUp(300,function(){e(this).parent().removeClass("opened").addClass("closed")}),e(".services_panel").prepend(t).find(".yith_wcevti_service_row:first-child").find(".yith-evti-service-panel").slideUp(300,function(){e(this).parent().addClass("opened").removeClass("closed")}),e(".service-type-container select").change(),e(".service-options-select").find("tbody").sortable(),e("#services_product_data").unblock(),y()})}function w(t){t.preventDefault();var i=e(t.target).closest(".yith_wcevti_service_row"),c=i.find(".yith_wcevti_service_select_panel").data("rows");c++,i.find(".yith_wcevti_service_select_panel").data("rows",c);var n=i.data("index");i.block({message:null,overlayCSS:{background:"#fff",opacity:.6}});var a={action:"print_select_service_row_action",index:c,row_index:n,service_label:""};e.post(ajaxurl,a).success(function(e){i.find(".yith_wcevti_service_select_panel").find("table").find("tbody").append(e),i.unblock()})}function k(){e(document).on("click",".map_options",function(){var t=e("#map_product_data"),i=t.find(".yith_wcevti_address_map");if(i.length>0){var c=t.find(".yith_wcevti_latitude_event").val(),n=t.find(".yith_wcevti_longitude_event").val(),a=new google.maps.LatLng(c,n),s=b(i[0],a),o=m(a,s);C(s,o,a),x(s,t,o),google.maps.event.trigger(s,"resize")}}),e("#_direction_event_field").on("change",function(){0==e(this).val().length?(e("#_display_map_tab").prop("checked",!1),e("#_display_map_tab").prop("disabled",!0)):e("#_display_map_tab").prop("disabled",!1)}),e("#_direction_event_field").trigger("change")}function b(e,t){var i={zoom:15,center:t};return new google.maps.Map(e,i)}function m(e,t){return new google.maps.Marker({position:e,map:t})}function x(e,t,i){var c=t.find(".yith_wcevti_direction_event"),n=t.find(".yith_wcevti_latitude_event"),a=t.find(".yith_wcevti_longitude_event");c.keyup(function(e){13==e.keyCode&&e.preventDefault()});var s=new google.maps.places.SearchBox(c[0]);e.addListener("bounds_changed",function(){s.setBounds(e.getBounds())});s.addListener("places_changed",function(){var t=s.getPlaces();0!=t.length&&(t.forEach(function(t){C(e,i,t.geometry.location)}),n.val(i.getPosition().lat()),a.val(i.getPosition().lng()))})}function C(e,t,i){e.setCenter(i),t.setPosition(i)}function D(){e("#_display_tab_assistants").on("change",function(){e(this).is(":checked")?e("._display_organizers_field").show():e("._display_organizers_field").hide()}).change()}function S(){e("#_display_barcode").on("change",function(){e(this).is(":checked")?e("._type_barcode_field").show():e("._type_barcode_field").hide()}).change(),e(".yith_wcevti_mail_template_default .yith_wcevti_mail_button").click(function(t){t.preventDefault(),$uri_field=e(this).next(".image_uri"),$id_field=e($uri_field).next(".image_id");var i=wp.media({title:"Upload Image",multiple:!1}).open().on("select",function(e){var t=i.state().get("selection").first(),c=t.toJSON().url,n=t.toJSON().id;$uri_field.val(c),$id_field.val(n)})}),e(".yith_wcevti_mail_template_default .yith_wcevti_mail_remove_button").click(function(t){t.preventDefault(),$id_field=e(this).prev(".image_id"),$uri_field=e($id_field).prev(".image_uri"),$id_field.val(""),$uri_field.val("")})}function $(){e("#_export_csv_button>a").click(function(e){e.preventDefault()})}var j=e(".yith_wcevti_service_row").length;t(),h(),f(),k(),D(),S(),$()});